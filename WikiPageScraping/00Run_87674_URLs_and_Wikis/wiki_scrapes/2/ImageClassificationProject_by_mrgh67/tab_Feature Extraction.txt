[<div class="wiki-body gollum-markdown-content instapaper_body" id="wiki-body">
        <div class="markdown-body">
          <p>The approach taken to feature extraction was based on the paper by Thomas Serre, et al. entitled "Robust Object Recognition with Cortex-Like mechanisms". While this paper generated the overall strategy the detailed approach was tuned for the image classification task at hand - notably classifying tiny images.</p>
<p>The overall thrust of the paper cited above aims to emulate the process of object recognition that occurs within the human cerebral cortex. Serre et al. based their system on a quantitative theory derived from cells operating within the visual cortex. The key element in the approach was to develop a set of scale and position tolerant feature detectors that agree quantitatively with visual cortical cell properties.</p>
<p>The initial gray scale image is analyzed using filter banks of Gabor filters. A Gabor filter is a linear filter that can be oriented at any angle to the image. Essentially a Gabor filter is an edge detector with multiple tuning parameters, including frequency. Gabor filters have been shown to be a good approximation to what the simplest receptive field cells in the visual cortex do.</p>
<p>All code relevant to the Gabor Filter feature extraction is encapsulated in the Python class "gaborFeatureExtraction()".</p>
<p>Below are the filter outputs of the Gabor Filter Banks for two of the tiny images, the first a truck and the second a frog.</p>
<p>Across the top A1 to A8 represent the orientation angle of the filter to the image. Rather than use just four orientations I opted to use 8 - 0, 22.5, 45. 67.5, 90, 112.5, 135, and 157.5 degrees. Note carefully that a filter at 0 degrees is equivalent to one at 180 degrees. A1 is 0 degrees, A2 is 22.5 degrees, and so on.</p>
<p>For each angle the filter was also adjusted for it's physical size and it's frequency of operation. Essentially small, high frequency through to larger, low frequency filters were used. The fourteen rows in the images below represent a frequency setting from 0.8 to 3.2 accompanied by an expanding filter size from 3 to 27 pixels. S1 is a filter size of 5 pixels, S2 is a filter size of 7 pixels, and so on.</p>
<p>The aim is to collect a representative set of filtered images for each image. Filtering around the image with different frequencies is designed to capture as many of the major edge based features of any particular image, as well as providing some insensitivity to rotation and scale.</p>
<h3>
<a aria-hidden="true" class="anchor" href="#truck-gabor-filters" id="user-content-truck-gabor-filters"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Truck Gabor Filters:</h3>
<p><img alt="" data-canonical-src="http://www.chilledimage.com/images/featureEA1.jpg" src="https://camo.githubusercontent.com/78bd6658b359da0b45e83d6e9fa7bd836fd77735/687474703a2f2f7777772e6368696c6c6564696d6167652e636f6d2f696d616765732f666561747572654541312e6a7067"/></p>
<h3>
<a aria-hidden="true" class="anchor" href="#frog-gabor-filters" id="user-content-frog-gabor-filters"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>Frog Gabor Filters:</h3>
<p><img alt="" data-canonical-src="http://www.chilledimage.com/images/featureEB1.jpg" src="https://camo.githubusercontent.com/679f8d638e68323e93096be76bbd64b95150babd/687474703a2f2f7777772e6368696c6c6564696d6167652e636f6d2f696d616765732f666561747572654542312e6a7067"/></p>
<p>Following the collection of the Gabor filters further processing occurs. Each pair of filters (rows in the above diagram) is considered a "filter band". Rows 1 and 2 above, for example, would constitute a single band. Although the parameters making up the filter for rows 1 and 2 are not identical, they are, however, not dissimilar.</p>
<p>While maintaining each orientation independently of the others a small overlapped pixel grid is passed over each  of the filtered images recording the maximum pixel intensity obtained. For example, a small 4 pixel by 4 pixel grid is used to find the maximum intensity pixel within the grid. This grid is used to sample over the 32 by 32 pixel filter image with a small overlap.</p>
<p><img alt="" data-canonical-src="http://www.chilledimage.com/images/Band_collapse_diagram.jpg" src="https://camo.githubusercontent.com/89e1695c85d5c8b504e365105374579139d30f9b/687474703a2f2f7777772e6368696c6c6564696d6167652e636f6d2f696d616765732f42616e645f636f6c6c617073655f6469616772616d2e6a7067"/></p>
<p>Once each pair of filters within a band has been sampled using the grids, the two grids are collapsed into one by recording the maximum intensity value between the two. A2S2 and A2S3 in the diagrams above constitute a pair of Gabor filter images in the band (images from the first 2 rows) for orientation angle A2. In the images below their pooled grids are called S2Band1.</p>
<p>These pooled band grid images are small, ranging from 4 by 4 pixels to 8 by 8 pixels. These are the features that will represent the input into the classifier.</p>
<p><img alt="" data-canonical-src="http://www.chilledimage.com/images/featureEA2.jpg" src="https://camo.githubusercontent.com/19680b7d1e44691e337c0fc68e2295a491f965dd/687474703a2f2f7777772e6368696c6c6564696d6167652e636f6d2f696d616765732f666561747572654541322e6a7067"/></p>
<p><img alt="" data-canonical-src="http://www.chilledimage.com/images/featureEB2.jpg" src="https://camo.githubusercontent.com/12fdc9728757ae2f87062013ba1b8f25fbcc4534/687474703a2f2f7777772e6368696c6c6564696d6167652e636f6d2f696d616765732f666561747572654542322e6a7067"/></p>

        </div>

    </div>]