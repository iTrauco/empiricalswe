[<div class="wiki-body gollum-markdown-content instapaper_body" id="wiki-body">
        <div class="markdown-body">
          <p>This page is for convenience and replicates <a href="https://docs.planetteamspeak.com/ts3/php/framework/index.html#example_sec" rel="nofollow">Usage Examples</a> from the official docs.</p>
<h3>
<a aria-hidden="true" class="anchor" href="#1-kick-a-single-client-from-a-virtual-server" id="user-content-1-kick-a-single-client-from-a-virtual-server"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>1. Kick a single Client from a Virtual Server</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> kick the client with ID 123 from the server</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>clientKick(<span class="pl-c1">123</span>, <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">KICK_SERVER</span>, <span class="pl-s"><span class="pl-pds">"</span>evil kick XD<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> spawn an object for the client by unique identifier and do the kick</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>clientGetByUid(<span class="pl-s"><span class="pl-pds">"</span>FPMPSC6MXqXq751dX7BKV0JniSo=<span class="pl-pds">"</span></span>)<span class="pl-k">-&gt;</span>kick(<span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">KICK_SERVER</span>, <span class="pl-s"><span class="pl-pds">"</span>evil kick XD<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> spawn an object for the client by current nickname and do the kick</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>clientGetByName(<span class="pl-s"><span class="pl-pds">"</span>ScP<span class="pl-pds">"</span></span>)<span class="pl-k">-&gt;</span>kick(<span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">KICK_SERVER</span>, <span class="pl-s"><span class="pl-pds">"</span>evil kick XD<span class="pl-pds">"</span></span>);</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#2-kick-all-clients-from-a-virtual-server" id="user-content-2-kick-all-clients-from-a-virtual-server"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>2. Kick all Clients from a Virtual Server</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> query clientlist from virtual server</span></span>
<span class="pl-s1"><span class="pl-smi">$arr_ClientList</span> <span class="pl-k">=</span> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>clientList();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> kick all clients online with a single command</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>clientKick(<span class="pl-smi">$arr_ClientList</span>, <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">KICK_SERVER</span>, <span class="pl-s"><span class="pl-pds">"</span>evil kick XD<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">#</span>## 3. Print the Nicknames of connected Android Clients</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-s"><span class="pl-pds">`</span><span class="pl-pds">`</span><span class="pl-pds">`</span>php</span></span>
<span class="pl-s1"><span class="pl-s">// load framework files</span></span>
<span class="pl-s1"><span class="pl-s">require_once("libraries/TeamSpeak3/TeamSpeak3.php");</span></span>
<span class="pl-s1"><span class="pl-s"></span></span>
<span class="pl-s1"><span class="pl-s">// connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-s"><span class="pl-smi">$ts3_VirtualServer</span> = TeamSpeak3::factory("serverquery://username:password@127.0.0.1:10011/?server_port=9987");</span></span>
<span class="pl-s1"><span class="pl-s"></span></span>
<span class="pl-s1"><span class="pl-s">// query clientlist from virtual server and filter by platform</span></span>
<span class="pl-s1"><span class="pl-s"><span class="pl-smi">$arr_ClientList</span> = <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span><span class="pl-smi">clientList</span>(array("client_platform" =&gt; "Android"));</span></span>
<span class="pl-s1"><span class="pl-s"></span></span>
<span class="pl-s1"><span class="pl-s">// walk through list of clients</span></span>
<span class="pl-s1"><span class="pl-s">foreach(<span class="pl-smi">$arr_ClientList</span> as <span class="pl-smi">$ts3_Client</span>)</span></span>
<span class="pl-s1"><span class="pl-s">{</span></span>
<span class="pl-s1"><span class="pl-s"> echo <span class="pl-smi">$ts3_Client</span> . " is using " . <span class="pl-smi">$ts3_Client</span>["client_platform"] . "&lt;br /&gt;<span class="pl-cce">\n</span>";</span></span>
<span class="pl-s1"><span class="pl-s">}</span></span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#4-modify-the-settings-of-each-virtual-server" id="user-content-4-modify-the-settings-of-each-virtual-server"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>4. Modify the Settings of each Virtual Server</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the server instance</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_ServerInstance</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> walk through list of virtual servers</span></span>
<span class="pl-s1"><span class="pl-k">foreach</span>(<span class="pl-smi">$ts3_ServerInstance</span> <span class="pl-k">as</span> <span class="pl-smi">$ts3_VirtualServer</span>)</span>
<span class="pl-s1">{</span>
<span class="pl-s1"> <span class="pl-c"><span class="pl-c">//</span> modify the virtual servers hostbanner URL only using the ArrayAccess interface</span></span>
<span class="pl-s1"> <span class="pl-smi">$ts3_VirtualServer</span>[<span class="pl-s"><span class="pl-pds">"</span>virtualserver_hostbanner_gfx_url<span class="pl-pds">"</span></span>] <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>http://www.example.com/banners/banner01_468x60.jpg<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"> <span class="pl-c"><span class="pl-c">//</span> modify the virtual servers hostbanner URL only using property overloading</span></span>
<span class="pl-s1"> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span><span class="pl-smi">virtualserver_hostbanner_gfx_url</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>http://www.example.com/banners/banner01_468x60.jpg<span class="pl-pds">"</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"> <span class="pl-c"><span class="pl-c">//</span> modify multiple virtual server properties at once</span></span>
<span class="pl-s1"> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>modify(<span class="pl-c1">array</span>(</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>virtualserver_hostbutton_tooltip<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>My Company<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>virtualserver_hostbutton_url<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>http://www.example.com<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>virtualserver_hostbutton_gfx_url<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>http://www.example.com/buttons/button01_24x24.jpg<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> ));</span>
<span class="pl-s1">}</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#5-create-a-privilege-key-for-a-server-group" id="user-content-5-create-a-privilege-key-for-a-server-group"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>5. Create a Privilege Key for a Server Group</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> spawn an object for the group using a specified name</span></span>
<span class="pl-s1"><span class="pl-smi">$arr_ServerGroup</span> <span class="pl-k">=</span> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>serverGroupGetByName(<span class="pl-s"><span class="pl-pds">"</span>Admins<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> create the privilege key</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_PrivilegeKey</span> <span class="pl-k">=</span> <span class="pl-smi">$arr_ServerGroup</span><span class="pl-k">-&gt;</span>privilegeKeyCreate();</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#6-modify-the-permissions-of-admins-on-each-virtual-server" id="user-content-6-modify-the-permissions-of-admins-on-each-virtual-server"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>6. Modify the Permissions of Admins on each Virtual Server</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the server instance</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_ServerInstance</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> walk through list of virtual servers</span></span>
<span class="pl-s1"><span class="pl-k">foreach</span>(<span class="pl-smi">$ts3_ServerInstance</span> <span class="pl-k">as</span> <span class="pl-smi">$ts3_VirtualServer</span>)</span>
<span class="pl-s1">{</span>
<span class="pl-s1"> <span class="pl-c"><span class="pl-c">//</span> identify the most powerful group on the virtual server</span></span>
<span class="pl-s1"> <span class="pl-smi">$ts3_ServerGroup</span> <span class="pl-k">=</span> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>serverGroupIdentify();</span>
<span class="pl-s1"> <span class="pl-c"><span class="pl-c">//</span> assign a new permission</span></span>
<span class="pl-s1"> <span class="pl-smi">$ts3_ServerGroup</span><span class="pl-k">-&gt;</span>permAssign(<span class="pl-s"><span class="pl-pds">"</span>b_virtualserver_modify_hostbanner<span class="pl-pds">"</span></span>, <span class="pl-c1">TRUE</span>);</span>
<span class="pl-s1"> <span class="pl-c"><span class="pl-c">//</span> revoke an existing permission</span></span>
<span class="pl-s1"> <span class="pl-smi">$ts3_ServerGroup</span><span class="pl-k">-&gt;</span>permRemove(<span class="pl-s"><span class="pl-pds">"</span>b_virtualserver_modify_maxclients<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">}</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#7-create-a-new-virtual-server" id="user-content-7-create-a-new-virtual-server"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>7. Create a new Virtual Server</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the server instance</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_ServerInstance</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> create a virtual server and get its ID</span></span>
<span class="pl-s1"><span class="pl-smi">$new_sid</span> <span class="pl-k">=</span> <span class="pl-smi">$ts3_ServerInstance</span><span class="pl-k">-&gt;</span>serverCreate(<span class="pl-c1">array</span>(</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>virtualserver_name<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>My TeamSpeak 3 Server<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>virtualserver_maxclients<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">64</span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>virtualserver_hostbutton_tooltip<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>My Company<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>virtualserver_hostbutton_url<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>http://www.example.com<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>virtualserver_hostbutton_gfx_url<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>http://www.example.com/buttons/button01_24x24.jpg<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1">));</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#8-create-a-hierarchical-channel-stucture" id="user-content-8-create-a-hierarchical-channel-stucture"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>8. Create a hierarchical Channel Stucture</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> create a top-level channel and get its ID</span></span>
<span class="pl-s1"><span class="pl-smi">$top_cid</span> <span class="pl-k">=</span> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>channelCreate(<span class="pl-c1">array</span>(</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>channel_name<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>My Channel<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>channel_topic<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>This is a top-level channel<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>channel_codec<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">CODEC_SPEEX_WIDEBAND</span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>channel_flag_permanent<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">TRUE</span>,</span>
<span class="pl-s1">));</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> create a sub-level channel and get its ID</span></span>
<span class="pl-s1"><span class="pl-smi">$sub_cid</span> <span class="pl-k">=</span> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>channelCreate(<span class="pl-c1">array</span>(</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>channel_name<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>My Sub-Channel<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>channel_topic<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>This is a sub-level channel<span class="pl-pds">"</span></span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>channel_codec<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">CODEC_SPEEX_NARROWBAND</span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>channel_flag_permanent<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">TRUE</span>,</span>
<span class="pl-s1"> <span class="pl-s"><span class="pl-pds">"</span>cpid<span class="pl-pds">"</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$top_cid</span>,</span>
<span class="pl-s1">));</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#9-create-a-simple-tsviewer-for-your-website" id="user-content-9-create-a-simple-tsviewer-for-your-website"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>9. Create a simple TSViewer for your Website</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> build and display HTML treeview using custom image paths (remote icons will be embedded using data URI sheme)</span></span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>getViewer(<span class="pl-k">new</span> <span class="pl-c1">TeamSpeak3_Viewer_Html</span>(<span class="pl-s"><span class="pl-pds">"</span>images/viewericons/<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>images/countryflags/<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>data:image<span class="pl-pds">"</span></span>));</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#10-update-all-outdated-audio-codecs-to-their-opus-equivalent" id="user-content-10-update-all-outdated-audio-codecs-to-their-opus-equivalent"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>10. Update all outdated Audio Codecs to their Opus equivalent</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> walk through list of chanels</span></span>
<span class="pl-s1"><span class="pl-k">foreach</span>(<span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>channelList() <span class="pl-k">as</span> <span class="pl-smi">$ts3_Channel</span>)</span>
<span class="pl-s1">{</span>
<span class="pl-s1"> <span class="pl-k">if</span>(<span class="pl-smi">$ts3_Channel</span>[<span class="pl-s"><span class="pl-pds">"</span>channel_codec<span class="pl-pds">"</span></span>] <span class="pl-k">==</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">CODEC_CELT_MONO</span>)</span>
<span class="pl-s1"> {</span>
<span class="pl-s1"> <span class="pl-smi">$ts3_Channel</span>[<span class="pl-s"><span class="pl-pds">"</span>channel_codec<span class="pl-pds">"</span></span>] <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">CODEC_OPUS_MUSIC</span>;</span>
<span class="pl-s1"> }</span>
<span class="pl-s1"> <span class="pl-k">elseif</span>(<span class="pl-smi">$ts3_Channel</span>[<span class="pl-s"><span class="pl-pds">"</span>channel_codec<span class="pl-pds">"</span></span>] <span class="pl-k">!</span><span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">CODEC_OPUS_MUSIC</span>)</span>
<span class="pl-s1"> {</span>
<span class="pl-s1"> <span class="pl-smi">$ts3_Channel</span>[<span class="pl-s"><span class="pl-pds">"</span>channel_codec<span class="pl-pds">"</span></span>] <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span><span class="pl-c1">CODEC_OPUS_VOICE</span>;</span>
<span class="pl-s1"> }</span>
<span class="pl-s1">}</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#11-display-the-avatar-of-a-connected-user" id="user-content-11-display-the-avatar-of-a-connected-user"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>11. Display the Avatar of a connected User</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> spawn an object for the client using a specified nickname</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_Client</span> <span class="pl-k">=</span> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>clientGetByName(<span class="pl-s"><span class="pl-pds">"</span>John Doe<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> download the clients avatar file</span></span>
<span class="pl-s1"><span class="pl-smi">$avatar</span> <span class="pl-k">=</span> <span class="pl-smi">$ts3_Client</span><span class="pl-k">-&gt;</span>avatarDownload();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> send header and display image</span></span>
<span class="pl-s1"><span class="pl-c1">header</span>(<span class="pl-s"><span class="pl-pds">"</span>Content-Type: <span class="pl-pds">"</span></span> <span class="pl-k">.</span> <span class="pl-c1">TeamSpeak3_Helper_Convert</span><span class="pl-k">::</span>imageMimeType(<span class="pl-smi">$avatar</span>));</span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-smi">$avatar</span>;</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#12-create-a-simple-bot-waiting-for-events" id="user-content-12-create-a-simple-bot-waiting-for-events"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>12. Create a Simple Bot waiting for Events</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server in non-blocking mode, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987&amp;blocking=0<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> get notified on incoming private messages</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>notifyRegister(<span class="pl-s"><span class="pl-pds">"</span>textprivate<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> register a callback for notifyTextmessage events </span></span>
<span class="pl-s1"><span class="pl-c1">TeamSpeak3_Helper_Signal</span><span class="pl-k">::</span>getInstance()<span class="pl-k">-&gt;</span>subscribe(<span class="pl-s"><span class="pl-pds">"</span>notifyTextmessage<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>onTextmessage<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> wait for events</span></span>
<span class="pl-s1"><span class="pl-k">while</span>(<span class="pl-c1">1</span>) <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>getAdapter()<span class="pl-k">-&gt;</span>wait();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> define a callback function</span></span>
<span class="pl-s1"><span class="pl-k">function</span> <span class="pl-en">onTextmessage</span>(<span class="pl-c1">TeamSpeak3_Adapter_ServerQuery_Event</span> <span class="pl-smi">$event</span>, <span class="pl-c1">TeamSpeak3_Node_Host</span> <span class="pl-smi">$host</span>)</span>
<span class="pl-s1">{</span>
<span class="pl-s1"> <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>Client <span class="pl-pds">"</span></span> <span class="pl-k">.</span> <span class="pl-smi">$event</span>[<span class="pl-s"><span class="pl-pds">"</span>invokername<span class="pl-pds">"</span></span>] <span class="pl-k">.</span> <span class="pl-s"><span class="pl-pds">"</span> sent textmessage: <span class="pl-pds">"</span></span> <span class="pl-k">.</span> <span class="pl-smi">$event</span>[<span class="pl-s"><span class="pl-pds">"</span>msg<span class="pl-pds">"</span></span>];</span>
<span class="pl-s1">}</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#13-handle-errors-using-exceptions-and-custom-error-messages" id="user-content-13-handle-errors-using-exceptions-and-custom-error-messages"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>13. Handle Errors using Exceptions and Custom Error Messages</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> register custom error message (supported placeholders are: %file, %line, %code and %mesg)</span></span>
<span class="pl-s1"><span class="pl-c1">TeamSpeak3_Exception</span><span class="pl-k">::</span>registerCustomMessage(<span class="pl-c1">0x300</span>, <span class="pl-s"><span class="pl-pds">"</span>The specified channel does not exist; server said: %mesg<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">try</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1"> <span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"> <span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"> <span class="pl-c"><span class="pl-c">//</span> spawn an object for the channel using a specified name</span></span>
<span class="pl-s1"> <span class="pl-smi">$ts3_Channel</span> <span class="pl-k">=</span> <span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>channelGetByName(<span class="pl-s"><span class="pl-pds">"</span>I do not exist<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">}</span>
<span class="pl-s1"><span class="pl-k">catch</span>(<span class="pl-c1">TeamSpeak3_Exception</span> <span class="pl-smi">$e</span>)</span>
<span class="pl-s1">{</span>
<span class="pl-s1"> <span class="pl-c"><span class="pl-c">//</span> print the error message returned by the server</span></span>
<span class="pl-s1"> <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>Error <span class="pl-pds">"</span></span> <span class="pl-k">.</span> <span class="pl-smi">$e</span><span class="pl-k">-&gt;</span>getCode() <span class="pl-k">.</span> <span class="pl-s"><span class="pl-pds">"</span>: <span class="pl-pds">"</span></span> <span class="pl-k">.</span> <span class="pl-smi">$e</span><span class="pl-k">-&gt;</span>getMessage();</span>
<span class="pl-s1">}</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#14-save-connection-state-in-persistent-session-variable" id="user-content-14-save-connection-state-in-persistent-session-variable"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>14. Save Connection State in Persistent Session Variable</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> start a PHP session</span></span>
<span class="pl-s1"><span class="pl-c1">session_start</span>();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> connect to local server, authenticate and spawn an object for the virtual server on port 9987</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">TeamSpeak3</span><span class="pl-k">::</span>factory(<span class="pl-s"><span class="pl-pds">"</span>serverquery://username:password@127.0.0.1:10011/?server_port=9987<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> save connection state (including login and selected virtual server)</span></span>
<span class="pl-s1"><span class="pl-smi">$_SESSION</span>[<span class="pl-s"><span class="pl-pds">"</span>_TS3<span class="pl-pds">"</span></span>] <span class="pl-k">=</span> <span class="pl-c1">serialize</span>(<span class="pl-smi">$ts3_VirtualServer</span>);</span></pre></div>
<h3>
<a aria-hidden="true" class="anchor" href="#15-restore-connection-state-from-persistent-session-variable" id="user-content-15-restore-connection-state-from-persistent-session-variable"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill-rule="evenodd"></path></svg></a>15. Restore Connection State from Persistent Session Variable</h3>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> load framework files</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span>(<span class="pl-s"><span class="pl-pds">"</span>libraries/TeamSpeak3/TeamSpeak3.php<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> start a PHP session</span></span>
<span class="pl-s1"><span class="pl-c1">session_start</span>();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> restore connection state</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span> <span class="pl-k">=</span> <span class="pl-c1">unserialize</span>(<span class="pl-smi">$_SESSION</span>[<span class="pl-s"><span class="pl-pds">"</span>_TS3<span class="pl-pds">"</span></span>]);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> send a text message to the server</span></span>
<span class="pl-s1"><span class="pl-smi">$ts3_VirtualServer</span><span class="pl-k">-&gt;</span>message(<span class="pl-s"><span class="pl-pds">"</span>Hello World!<span class="pl-pds">"</span></span>);</span></pre></div>
<p>Speed up new development and reduce maintenance costs by using the TS3 PHP Framework!</p>

        </div>

    </div>]